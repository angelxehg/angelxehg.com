---
title: StudyLater
date: 2021-05-28
image: ../images/studylater.png
caption: Demostración de descarga y apertura de archivos
stack: ["React", "TypeScript", "Capacitor", "Android"]
published: true
---

Con la aparición de herramientas como <CreateLink from="Ionic"/> se ha popularizado el desarrollo de **Aplicaciones Hybridas**: *Apps* desarrolladas con tecnologías web, pero que a vista del usuario se comportan como *apps* nativas. Y uno de los diferenciadores clave que podemos incluir en nuestras aplicaciones Hybridas es la integración con funcionalidades del sistema, tales como Almacenamiento, Cámara, Notificaciones, Sensores, etc.

## La idea

La idea al desarrollar **StudyLater** es la de una aplicación donde se puedan descargar materiales de estudio, como PDFs, y tenerlos organizados y disponibles sin conexión. También la intención fue probar implementar estas funcionalidades a través de <CreateLink from="Capacitor"/>:

- Descargar y almacenar archivos
- Abrir archivos en el visor de PDF del sistema
- Inicio de sesión con Google de manera nativa

## Los retos

Una de las tareas más difíciles fue el descargar archivos. Para empezar, al utilizar la función `fetch()` para descargar archivos solían aparecer errores de *CORS*, sobre todo cuando las descargas provienen de sitios sin certificado SSL. Este comportamiento es el esperado dentro de JavaScript en un navegador, pero muchos de los PDFs que un usuario querría descargar están en FTPs públicos, sin HTTPS.

Para resolver esto, tendríamos que descargarlos con un cliente HTTP nativo, usando el plugin <CreateLink from="Cordova" extend={{
  title: "Advanced HTTP",
  href: "https://github.com/silkimen/cordova-plugin-advanced-http"
}}/>. Ahora la posibilidad de descargar desde HTTPS dependerá de la configuración de Android. Incluso este plugin ya incluye el método `download()`, y solo necesitaba saber en qué ubicación almacenar los archivos. Esto se resuelve con el plugin <CreateLink from="Cordova" extend={{
  title: "File",
  href: "https://ionicframework.com/docs/native/file"
}}/>

Para abrir los archivos utilicé el plugin <CreateLink from="Cordova" extend={{
  title: "File Opener",
  href: "https://github.com/pwlin/cordova-plugin-file-opener2"
}}/>. Además, para que el *login* de Google se sienta más nativo, utilicé el plugin <CreateLink from="Cordova" extend={{
  title: "Google Plus",
  href: "https://github.com/EddyVerbruggen/cordova-plugin-googleplus"
}}/>, y solo necesité registrar una aplicación Android en la consola de Firebase

## Resultados

Finalmente decidí detallar esta experiencia en un <CreateLink from="Dev.to" extend={{
  title: "artículo de dev.to",
  href: "https://dev.to/angelxehg/implementando-descargas-de-archivos-con-capacitor-cordova-4844"
}}/>, y que pueda servir de guía a cualquier persona que desee implementar una función de descarga en sus *apps*.

También probé la viabilidad de utilizar <CreateLink from="Capacitor"/> con otras tecnologías independientes de Ionic. Para construir las interfaces y darle vida a la aplicación utilicé  <CreateLink from="React"/>, así como para el diseño utilicé <CreateLink from="Bootstrap"/>, aunque quizá no sea muy adecuado para una aplicación móvil, como si lo es para un sitio web responsivo.

## Recursos y referencias

- <CreateLink from="Dev.to" extend={{
  title: "Implementando descargas de archivos con Capacitor/Cordova",
  href: "https://dev.to/angelxehg/implementando-descargas-de-archivos-con-capacitor-cordova-4844"
}}/>
- <CreateLink from="GitHub" extend={{
  title: "Código fuente del proyecto",
  href: "https://github.com/angelxehg/studylater-app"
}}/>
- <CreateLink from="Android" extend={{
  title: "Descargar APK",
  href: "https://github.com/angelxehg/studylater-app/releases"
}}/>
- <CreateLink from="Firebase" extend={{
  title: "Documentación Firebase",
  href: "https://firebase.google.com/docs"
}}/>
- <CreateLink from="Ionic" extend={{
  title: "Ionic Native",
  href: "https://ionicframework.com/docs/native/community"
}}/>
- <CreateLink from="Cordova" extend={{
  title: "Plugin File",
  href: "https://ionicframework.com/docs/native/file"
}}/>
- <CreateLink from="Cordova" extend={{
  title: "Plugin HTTP Nativo",
  href: "https://github.com/silkimen/cordova-plugin-advanced-http"
}}/>
- <CreateLink from="Cordova" extend={{
  title: "Plugin File Opener",
  href: "https://github.com/pwlin/cordova-plugin-file-opener2"
}}/>
- <CreateLink from="Cordova" extend={{
  title: "Plugin Google Plus",
  href: "https://github.com/EddyVerbruggen/cordova-plugin-googleplus"
}}/>
